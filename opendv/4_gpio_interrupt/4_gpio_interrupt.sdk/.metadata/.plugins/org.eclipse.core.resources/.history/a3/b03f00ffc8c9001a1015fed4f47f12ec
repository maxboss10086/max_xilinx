/*
 * user_led.c
 *
 *  Created on: 2020年7月12日
 *      Author: 57315
 */

//sys_include
#include "xparameters.h" //器件参数信息
#include "xstatus.h"     //包含XST_FAILURE和XST_SUCCESS的宏定义
#include "xil_printf.h"  //包含print()函数
#include "xgpiops.h"     //包含PS GPIO的函数
#include "sleep.h"       //包含sleep()函数
//user_include
#include "user_led.h"
#include "user_gpio.h"


void led_init(u32 pin){
	GPIO_model_OUT(pin);
	GPIO_EN(pin);
}

void key_init(u32 key){
	GPIO_model_IN(key);
	GPIO_EN(key);
}

void led_twinkle(u32 pin){
	GPIO_H(pin);
	sleep(1);
	GPIO_L(pin);
	sleep(1);
}

void key_led(u32 key,u32 pin){
	u32 result;
	result = GPIO_read(key);
	result = ~result;
	GPIO_write(pin,result);
}

void led_interrupt_init(){
	 //使能来自于Gpio器件的中断
	    XScuGic_Enable(gic_ins_ptr, GpioIntrId);
	 //设置KEY按键的中断类型为下降沿中断
	    XGpioPs_SetIntrTypePin(gpio, KEY, XGPIOPS_IRQ_TYPE_EDGE_FALLING);
	 //使能按键KEY中断
	    XGpioPs_IntrEnablePin(gpio, KEY);

}
